# config/sites.yml - WolfArchiver サイト設定ファイル
# 
# このファイルでアーカイブ対象となるサイトの設定を行います。
# 詳細は spec/config_loader_spec.md を参照してください。

sites:
  # サイト識別子（英数字とアンダースコアのみ）
  sow_europe:
    # 表示名
    name: "人狼物語＠欧州"
    
    # ベースURL
    base_url: "https://euros.sakura.ne.jp/sow/sow.cgi"
    
    # 文字エンコーディング（Shift_JIS, EUC-JP, UTF-8）
    encoding: "Shift_JIS"
    
    # リクエスト間隔（秒）
    wait_time: 2.0
    
    # アセット設定
    assets:
      download: true
      types:
        - css
        - js
        - images
      css_dir: "assets/css"
      js_dir: "assets/js"
      images_dir: "assets/images"
    
    # リンク書き換え設定
    link_rewrite:
      enabled: true
      exclude_domains: []
      fallback: "#"
    
    # ページ定義
    pages:
      index: ""
      village_list: "?cmd=oldlog"
      village_index: "?vid=%{village_id}&mode=all"
      village: "?vid=%{village_id}&turn=%{date}&mode=all"
      village_info: "?vid=%{village_id}&mode=all&cmd=vinfo"
      # user_list: "?cmd=ulist"
      user: "?prof=%{user_id}"
      static:
        - "?cmd=about"
        - "?cmd=howto"
        - "?cmd=operate"
        - "?cmd=spec"
        - "?cmd=rolematrix"
        - "?cmd=rolelist"
        - "?cmd=prohibit"
        - "?cmd=chrlist&csid=sow"
        - "?cmd=chrlist&csid=rem"
        - "?cmd=chrlist&csid=imas"
        - "?cmd=changelog"
    
    # パスマッピング（URL → ファイルパス）
    path_mapping:
      # パラメータベースのマッピング（新形式）
      # URLパラメータの順序に依存せず、必要なパラメータで判定
      - params:
          vid: '(\d+)'
          cmd: 'vinfo'
        path: 'villages/%{vid}/vinfo.html'
      - params:
          vid: '(\d+)'
          mode: 'all'
        exact: true
        path: 'villages/%{vid}/index.html'
      - params:
          vid: '(\d+)'
          turn: '(\d+)'
        path: 'villages/%{vid}/day%{turn}.html'
      - params:
          prof: '(\d+)'
        path: 'users/%{prof}.html'
      
      # 正規表現ベースのマッピング（旧形式・後方互換性維持）
      # パラメータ順序が固定されている場合や、特定のクエリ文字列にマッチさせる場合
      - pattern: '^$'
        path: 'index.html'
      - pattern: '\?cmd=oldlog'
        path: 'village_list.html'
      - pattern: '\?cmd=(\w+)'
        path: 'static/%{1}.html'
